// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum WorkerStatus {
  AVAILABLE
  ON_TASK
  ON_BREAK
  ABSENT
}

enum TaskStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  BLOCKED
}

enum TaskPriority {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

model Skill {
  id          String   @id @default(cuid())
  name        String   @unique 
  workers     WorkerSkill[]
  requiredFor Task[]
}

model Worker {
  id           String        @id @default(cuid())
  name         String
  status       WorkerStatus  @default(AVAILABLE)
  fatigueLevel Float         @default(0.0) 
  location_x   Float         @default(0.0)
  location_y   Float         @default(0.0)
  skills       WorkerSkill[]
  assignedTask Task?
}


model WorkerSkill {
  workerId      String
  skillId       String
  proficiency   Int      @default(1) 

  worker        Worker   @relation(fields: [workerId], references: [id])
  skill         Skill    @relation(fields: [skillId], references: [id])

  @@id([workerId, skillId])
}


model Task {
  id              String        @id @default(cuid())
  description     String
  status          TaskStatus    @default(PENDING)
  priority        TaskPriority  @default(MEDIUM)
  requiredSkillId String?
  assignedWorkerId String?      @unique 

  requiredSkill   Skill?        @relation(fields: [requiredSkillId], references: [id])
  assignedWorker  Worker?       @relation(fields: [assignedWorkerId], references: [id])
}